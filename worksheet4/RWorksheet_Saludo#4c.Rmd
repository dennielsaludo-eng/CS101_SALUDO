---
title: "RWorksheet_Saludo#4c"
output:
  pdf_document: default
  html_document: default
---
```{r}
install.packages("readxl")
library(ggplot2)
library(dplyr)
```

#1
#a
```{r}
mpg_data <- read.csv("mpg.csv")
str(mpg)
```
#b manufacturer, model, trans, drv, fl, class, year (often treated as categorical)
#c displ, cty, hwy, cyl

#2
#a
```{r}
library(dplyr)

manufacturer_models <- mpg %>%
  group_by(manufacturer) %>%
  summarise(unique_models = n_distinct(model)) %>%
  arrange(desc(unique_models))

manufacturer_models
```
#a
```{r}
model_variations <- mpg %>%
  group_by(model) %>%
  summarise(variations = n()) %>%
  arrange(desc(variations))

model_variations
```
#b
```{r}
plot(manufacturer_models$unique_models,
     main = "Number of Models per Manufacturer",
     xlab = "Manufacturer Index",
     ylab = "Number of Models")

```
#b
```{r}
library(ggplot2)

ggplot(manufacturer_models,
       aes(x = reorder(manufacturer, unique_models),
           y = unique_models)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(title = "Unique Models per Manufacturer",
       x = "Manufacturer",
       y = "Number of Models")

```

#2b
#a
```{r}
ggplot(mpg, aes(model, manufacturer)) +
  geom_point()

```
#b
#not useful
```{r}
mpg %>%
  count(manufacturer, model) %>%
  ggplot(aes(x = manufacturer, y = model, size = n)) +
  geom_point(alpha = 0.6)

```

#3
```{r}
top20 <- mpg[1:20, ]

ggplot(top20, aes(x = model, y = year)) +
  geom_point(color = "darkred") +
  labs(title = "Car Models vs Year (Top 20)",
       x = "Model",
       y = "Year") +
  theme(axis.text.x = element_text(angle = 90))

```

#4
```{r}
model_count <- mpg %>%
  group_by(model) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

model_count

```
#a
```{r}
top20_models <- model_count %>% slice_max(count, n = 20)

ggplot(top20_models, aes(x = model, y = count)) +
  geom_bar(stat = "identity", fill = "darkgreen") +
  labs(title = "Top 20 Car Models",
       x = "Model",
       y = "Number of Cars") +
  theme(axis.text.x = element_text(angle = 90))

```
#b
```{r}
ggplot(top20_models, aes(x = reorder(model, count), y = count)) +
  geom_bar(stat = "identity", fill = "orange") +
  coord_flip() +
  labs(title = "Top 20 Car Models (Flipped)",
       x = "Model",
       y = "Number of Cars")

```

#5
```{r}
ggplot(mpg, aes(x = cyl, y = displ, color = displ)) +
  geom_point() +
  labs(title = "Relationship between No. of Cylinders and Engine Displacement",
       x = "Number of Cylinders",
       y = "Engine Displacement")

```

#6
#a
```{r}
ggplot(mpg, aes(x = displ, y = hwy, color = cty)) +
  geom_point() +
  labs(title = "Engine Displacement vs Highway MPG",
       x = "Engine Displacement",
       y = "Highway MPG")

```

#7
#a
```{r}
library(readxl)

alexa <- read_excel("alexa_file.xlsx")

```
#b
```{r}
dim(alexa)
```
#c
```{r}
variation_count <- alexa %>%
  group_by(variation) %>%
  summarise(total = n())

variation_count

```
#d
```{r}
ggplot(alexa, aes(x = date, y = verified_reviews)) +
  geom_line(color = "blue") +
  labs(title = "Verified Reviews Over Time",
       x = "Date",
       y = "Verified Reviews")

```
#e
```{r}
rating_variation <- alexa %>%
  group_by(variation) %>%
  summarise(avg_rating = mean(rating, na.rm = TRUE))

ggplot(rating_variation, aes(x = variation, y = avg_rating)) +
  geom_col(fill = "darkcyan") +
  labs(title = "Average Rating per Variation",
       x = "Variation",
       y = "Average Rating") +
  theme(axis.text.x = element_text(angle = 45))

```


